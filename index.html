<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>PizzaCalc Pro</title>
  <style>
    :root {
      --bg: #121212; --card: #1e1e1e; --primary: #ff4757; --accent: #f4a261;
      --text: #e8d7c1; --input-bg: #2a2a2a; --border: #333;
    }
    body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 100px; }
    header { background: linear-gradient(135deg, #8B1E3F, #ff4757); padding: 20px; text-align: center; }
    h1 { margin: 0; font-size: 1.4rem; color: white; }
    
    .container { padding: 15px; max-width: 500px; margin: auto; }
    .card { background: var(--card); border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid var(--border); }
    h3 { margin: 0 0 12px 0; color: var(--accent); font-size: 0.85rem; text-transform: uppercase; }

    /* Layout Helpers */
    .input-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    input, select { background: var(--input-bg); border: 1px solid #444; color: white; padding: 8px; border-radius: 6px; font-family: inherit; }
    input[type="number"] { width: 60px; text-align: center; }
    input[type="checkbox"] { width: 20px; height: 20px; accent-color: var(--primary); }
    
    .hidden { display: none; }
    .dim { opacity: 0.3; pointer-events: none; }

    .result-display { background: #000; color: #f4a261; padding: 15px; border-radius: 10px; font-family: monospace; font-size: 0.85rem; line-height: 1.6; }
    .section-head { color: var(--primary); font-weight: 800; display: block; margin-top: 10px; border-bottom: 1px solid #222; }
    .res-val { color: #fff; }
  </style>
</head>
<body>

<header><h1>PIZZACALC PRO v2</h1></header>

<div class="container">

  <!-- 1. INGREDIENT SELECTOR (The "Toggle" strategy) -->
  <div class="card">
    <h3>Active Ingredients</h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.8rem;">
      <label><input type="checkbox" id="useBiga" checked onchange="toggleInputs()"> Biga</label>
      <label><input type="checkbox" id="useOil" checked onchange="toggleInputs()"> Oil</label>
      <label><input type="checkbox" id="useSugar" checked onchange="toggleInputs()"> Sugar</label>
      <label><input type="checkbox" id="useMalt" checked onchange="toggleInputs()"> Malt</label>
      <label><input type="checkbox" id="useMSG" checked onchange="toggleInputs()"> MSG</label>
    </div>
  </div>

  <!-- 2. MAIN INPUTS -->
  <div class="card">
    <h3>Dough Basics</h3>
    <div class="input-row"><label>Pies / Weight(g)</label>
      <div><input type="number" id="numPies" value="3" oninput="calculate()"> <input type="number" id="targetW" value="340" oninput="calculate()"></div>
    </div>
    <div class="input-row"><label>Hydration (%)</label><input type="number" id="hydro" value="67" oninput="calculate()"></div>
    
    <!-- Conditional Inputs -->
    <div id="bigaSection">
        <div class="input-row"><label>Biga Flour (%)</label><input type="number" id="bigaF" value="30" oninput="calculate()"></div>
    </div>
  </div>

  <!-- 3. SAUCE (The "Library" test) -->
  <div class="card">
    <h3>Sauce Settings</h3>
    <div class="input-row">
      <label>Tomato Brand</label>
      <select id="tomatoBrand" onchange="updateSauceSalt()">
        <option value="custom">Custom / Other</option>
        <option value="brandA">Brand A (Low Salt - 0.35%)</option>
        <option value="brandB">Brand B (No Salt - 0.75%)</option>
      </select>
    </div>
    <div class="input-row">
      <label>Sauce Salt (%)</label>
      <input type="number" id="sauceSalt" value="0.75" step="0.05" oninput="calculate()">
    </div>
  </div>

  <!-- 4. RESULTS -->
  <div class="card">
    <h3>Live Recipe</h3>
    <div id="result" class="result-display"></div>
  </div>

</div>

<script>
  function toggleInputs() {
    // Show/Hide sections based on checkboxes
    document.getElementById('bigaSection').className = document.getElementById('useBiga').checked ? '' : 'hidden';
    calculate();
  }

  function updateSauceSalt() {
    const brand = document.getElementById('tomatoBrand').value;
    const saltInput = document.getElementById('sauceSalt');
    
    if (brand === 'brandA') saltInput.value = 0.35;
    if (brand === 'brandB') saltInput.value = 0.75;
    
    // If they choose a brand, let's dim the manual input to show it's "set"
    saltInput.style.opacity = (brand === 'custom') ? '1' : '0.5';
    
    calculate();
  }

  function calculate() {
    // Basic logic
    const n = parseFloat(document.getElementById("numPies").value) || 0;
    const w = parseFloat(document.getElementById("targetW").value) || 0;
    const h = (parseFloat(document.getElementById("hydro").value) || 0) / 100;
    
    // Check if ingredient is active, else use 0
    const useBiga = document.getElementById('useBiga').checked;
    const bigaPct = useBiga ? (parseFloat(document.getElementById("bigaF").value)/100) : 0;
    
    const sauceSalt = parseFloat(document.getElementById("sauceSalt").value);

    // Simplified math for demo
    let totalW = w * n;
    let flour = totalW / (1 + h + 0.02); // simplified constant for salt/yeast
    
    let res = `
      <span class="section-head">DOUGH BATCH</span>
      Total Flour: <span class="res-val">${flour.toFixed(1)}g</span><br>
      Total Water: <span class="res-val">${(flour * h).toFixed(1)}g</span><br>
    `;

    if (useBiga) {
      res += `
        <span class="section-head">BIGA</span>
        Biga Flour: <span class="res-val">${(flour * bigaPct).toFixed(1)}g</span>
      `;
    }

    res += `
      <span class="section-head">SAUCE NOTES</span>
      Salt to add: <span class="res-val">${sauceSalt}%</span>
    `;

    document.getElementById("result").innerHTML = res;
  }

  window.onload = calculate;
</script>
</body>
</html>